(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();const f=/^!poll$/,p=/^!poll [2-9]$/,E=/^!poll( "[^"]*")( "[^"]+"){2,}$/,m=/"([^"]*)"/g,_=/^!polltitle( "[^"]+")$/,v=/^!poll_tl$|^!poll_tr$|^!poll_br$|^!poll_bl$/,P=/^\s*(\d)(?: .*)?$/,T=e=>f.test(e)||p.test(e)||E.test(e),N=e=>/^!pollresume/g.test(e),g=e=>/^!pollend/g.test(e),y=e=>/^!pollstop/g.test(e),C=e=>_.test(e),I=e=>v.test(e),u=e=>{var n;return Boolean(((n=e.badges)==null?void 0:n.broadcaster)||e.mod)},A=(e,n)=>n.active&&n.visible&&P.test(e);function $(e,n){var t;if(T(e)&&!n.visible&&!n.active){const s={active:!0,visible:!0,title:"Poll",options:{},userVotes:{}};if(f.test(e))for(let o=1;o<=2;o++)s.options[o]=" ";else if(p.test(e)){const o=(t=e.match(/!poll (\d)/))==null?void 0:t[1];if(o)for(let i=1;i<=o;i++)s.options[i]=" "}else if(E.test(e)){const o=[...e.matchAll(m)].map(r=>r[1]),i=o.shift();s.title=i||"Poll",o.forEach((r,c)=>{s.options[c+1]=r})}return s}return n}function w(e){const n={...e};return n.active=!1,n}function V(e){const n={...e};return n.active=!0,n}function R(e){return{active:!1,visible:!1,title:"Poll",options:{},userVotes:{}}}function M(e,n){const t={...n},o=e.match(m).shift().replaceAll('"',"");return t.title=o,t}function D(e,n,t){var i;const s={...t},o=(i=e.match(P))==null?void 0:i[1];return o&&(s.options[o]||o==="0")&&(s.userVotes[n]=o),s}function h(e){return Object.entries(e.userVotes).reduce((n,[t,s])=>(s!=="0"&&(n[t]=s),n),{})}function B(e){const n=O(e);let t=[],s=0;return Object.entries(n).forEach(([o,i])=>{i==s?t.push(o):i>s&&(s=i,t=[o])}),t}function O(e){let n={};Object.keys(e.options).forEach(s=>{n[s]=0});const t=h(e);return Object.values(t).forEach(s=>{n[s]+=1}),n}function U(e){const n=h(e);return Object.keys(n).length}const j={active:!1,visible:!1,title:"Poll",options:{},userVotes:{}},q={active:!0,visible:!0,title:"Debug Mode Poll",options:{1:"Pizza",2:"Jam",3:"Coffee"},userVotes:{user1:"1",user2:"3",user3:"3"}},a={tl:"top-left",tr:"top-right",br:"bottom-right",bl:"bottom-left"};function b(e){const n=document.querySelector(".poll");n.style="visibility: visible;";const t=document.createElement("h1");t.id="poll-title",t.className="poll-title",t.innerHTML=e.title,n.append(t),Object.entries(e.options).forEach(([s,o])=>{const i=document.createElement("div");i.id=`option-${s}`,i.className="option";const r=document.createElement("div");r.innerHTML=`<div class="option-number">${s}</div> ${o}: <span class="percentage">0% (0)</span>`;const c=document.createElement("div");c.setAttribute("id",`progress-bar-container-${s}`),c.className="progress-bar-container";const l=document.createElement("div");l.className="progress-bar",l.setAttribute("id",`progress-bar-${s}`),c.append(l),i.append(r),i.append(c),n.append(i)})}function d(e){if(!e.visible){const o=document.querySelector(".poll");o.innerHTML="",o.style="visibility: hidden";return}const n=document.getElementById("poll-title");n.innerHTML=e.title;const t=U(e),s=O(e);if(Object.keys(e.options).forEach(o=>{const i=document.querySelector(`#option-${o} .percentage`),r=document.querySelector(`#progress-bar-${o}`),c=s[o]||0,l=t===0||c===0?0:Math.round(c/t*100);r.style.width=l+"%",i.innerHTML=`${l}% (${c})`}),e.active)Object.keys(e.options).forEach(o=>{const i=document.getElementById(`option-${o}`);i.className="option"});else{const o=B(e);if(o.length===1){const i=document.getElementById(`option-${o[0]}`);i.classList.add("winning-option"),i.classList.add("animate__animated"),i.classList.add("animate__bounceIn")}else o.length>1&&o.forEach(i=>{const r=document.getElementById(`option-${i}`);r.classList.add("draw-option"),r.classList.add("animate__animated"),r.classList.add("animate__shakeX")})}}function H(e){const n=e.split("_")[1],t=document.querySelector(".container"),s=a[n];t.classList.remove("top-left","top-right","bottom-right","bottom-left"),t.classList.add(s)}function x(e,n,t){return T(n)&&u(e)&&!t.visible&&!t.active?(t=$(n,t),b(t),t):y(n)&&u(e)?(t=w(t),d(t),t):N(n)&&u(e)?(t=V(t),d(t),t):g(n)&&u(e)?(t=R(),d(t),t):C(n)&&u(e)?(t=M(n,t),d(t),t):I(n)&&u(e)?(H(n),t):(A(n,t)&&(t=D(n,e.username,t),d(t)),t)}function X(){const e=new URLSearchParams(window.location.search),n=e.get("position");let t="top-left";n&&a[n]&&(t=a[n]);const s=e.has("debug");document.querySelector(".container").classList.add(t);const o=e.get("channel"),i=tmi.Client({channels:[o]});let r;s?(r={...q},b(r),d(r)):r={...j},i.connect(),i.on("message",(c,l,L)=>r=x(l,L,r))}document.addEventListener("DOMContentLoaded",X);
